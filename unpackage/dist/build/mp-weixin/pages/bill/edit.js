(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/bill/edit"],{"1a30":function(t,e,n){"use strict";(function(t){n("b40f"),n("921b");o(n("66fd"));var e=o(n("8da3"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},"3a9a":function(t,e,n){"use strict";(function(t,o){function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u(t){return d(t)||l(t)||c(t)||s()}function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(t,e){if(t){if("string"===typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}function l(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function d(t){if(Array.isArray(t))return f(t)}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var p=function(){n.e("node-modules/@dcloudio/uni-ui/lib/uni-popup/uni-popup").then(function(){return resolve(n("d00b"))}.bind(null,n)).catch(n.oe)},h=function(){n.e("node-modules/@dcloudio/uni-ui/lib/uni-nav-bar/uni-nav-bar").then(function(){return resolve(n("c389"))}.bind(null,n)).catch(n.oe)},b=function(){Promise.all([n.e("common/vendor"),n.e("node-modules/@dcloudio/uni-ui/lib/uni-icons/uni-icons")]).then(function(){return resolve(n("8abe"))}.bind(null,n)).catch(n.oe)},m=function(){n.e("node-modules/@buuug7/uniapp-components/lib/simple-datetime-picker/index").then(function(){return resolve(n("4e16"))}.bind(null,n)).catch(n.oe)},y={components:{uniIcons:b,uniNavBar:h,uniPopup:p,simpleDatetimePicker:m},data:function(){return{Token:t.getStorageSync("userId")||"",ismolnum:1,paytype:[],types:{collect:[],branch:[]},dataobj:{genre:1,amount:"",useDate:"",payType:{},useType:{},remarks:"",picture:""},typeitems:[]}},onLoad:function(t){if(this.paytype=u(this.GlobalJson.paytype),t.item){var e=JSON.parse(t.item);this.dataobj=e}else this.dataobj.useDate=this.utils.Format(new Date)},onShow:function(){this.gettypelist()},methods:{toback:function(){this.dataobj._id?t.redirectTo({url:"./details?id="+this.dataobj._id}):t.navigateBack({delta:1})},handleexin:function(t){if(this.$refs.popup.close(),this.dataobj.genre=t,this.gettypelist(),this.dataobj._id)this.dataobj.useType={};else{var e={genre:t,amount:"",useDate:"",payType:{},useType:{},remarks:""};e.useDate=this.utils.Format(new Date),this.dataobj=e}},gettypelist:function(){var e=this;o.callFunction({name:"settype",data:{pay:4,token:this.Token,genre:this.dataobj.genre}}).then((function(n){var o=[{iconclass:"iconjia",label:"编辑",isadd:!0}];if(0==n.result.status){e.isnull=!1;var a=u(n.result.list.data);e.typeitems=[].concat(u(a),o)}else e.typeitems=[].concat(o),t.showToast({title:n.result.msg,icon:"none"})})).catch((function(e){t.hideLoading(),t.showModal({content:"操作失败，请重新操作",showCancel:!1})}))},showModel:function(t){this.ismolnum=t,this.$refs.popup.open()},upload:function(){var e=this;new Promise((function(e,n){t.chooseImage({chooseImage:1,success:function(t){var n=t.tempFilePaths[0],o={filePath:n};e(o)},fail:function(){n(new Error("Fail_Cancel"))}})})).then((function(e){return t.showLoading({title:"文件上传中..."}),o.uploadFile(e)})).then((function(n){t.hideLoading(),t.showToast({title:"图片上传成功",mask:!0}),e.dataobj.picture=n.fileID})).catch((function(e){t.hideLoading(),console.log(e),"Fail_Cancel"!==e.message&&t.showModal({content:"图片上传失败，请重新上传",showCancel:!1})}))},seeimgsrc:function(){this.$refs.picture.open()},closeimgSrc:function(){this.dataobj.picture=""},saveData:function(){if(this.dataobj.amount)if(this.dataobj.payType.label)if(this.dataobj.useType.label){t.showLoading({title:"数据保存中...",mask:!0});var e=i({},this.dataobj),n="",a=this;e.useDategetTime=new Date(e.useDate).getTime();var r=e.useDate.split(" "),u=r[0].split("-");e.useYear=u[0],e.useMonth=u[1],e.useDay=u[2],e.useHour=r[1],e.token=this.Token,n=e._id?"update":"add",o.callFunction({name:n,data:e}).then((function(n){if(console.log(n),n.result.id){if(t.hideLoading(),t.showToast({title:"数据保存成功",mask:!0,duration:2e3}),e.dataId){e._id=e.dataId,delete e.dataId;try{t.setStorageSync("editData",e)}catch(o){}}setTimeout((function(){a.toback()}),2500)}else t.showToast({title:"保存失败，请重新输入",icon:"none",mask:!0,duration:2e3})})).catch((function(e){t.hideLoading(),t.showToast({title:"数据保存失败，请重新保存",mask:!0,icon:"none",duration:2e3}),console.error(e)}))}else t.showToast({title:"请选择方式",icon:"none"});else t.showToast({title:"请选择方式",icon:"none"});else t.showToast({title:"请输入金额",icon:"none"})},oninput:function(t){var e=this;t.target.value=t.target.value.match(/^\d*(\.?\d{0,2})/g)[0]||null,setTimeout((function(){e.dataobj.amount=t.target.value}),50)},handlepay:function(t){this.dataobj.payType=t,this.$refs.popup.close()},handleType:function(e){this.$refs.popup.close(),e.isadd?t.navigateTo({url:"./typelist?genre="+this.dataobj.genre}):this.dataobj.useType=e},openDatetimePicker:function(){this.$refs.myPicker.show()},closeDatetimePicker:function(){this.$refs.myPicker.hide()},handleSubmit:function(t){t.year&&t.month&&t.day&&(this.dataobj.useDate="".concat(t.year,"-").concat(t.month,"-").concat(t.day," ").concat(t.hour,":").concat(t.minute))}}};e.default=y}).call(this,n("543d")["default"],n("a9ff")["default"])},"667e":function(t,e,n){"use strict";var o,a=function(){var t=this,e=t.$createElement;t._self._c},i=[];n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o}))},"8da3":function(t,e,n){"use strict";n.r(e);var o=n("667e"),a=n("f64b");for(var i in a)"default"!==i&&function(t){n.d(e,t,(function(){return a[t]}))}(i);n("e816");var r,u=n("f0c5"),s=Object(u["a"])(a["default"],o["b"],o["c"],!1,null,"3788a3cb",null,!1,o["a"],r);e["default"]=s.exports},be85:function(t,e,n){},e816:function(t,e,n){"use strict";var o=n("be85"),a=n.n(o);a.a},f64b:function(t,e,n){"use strict";n.r(e);var o=n("3a9a"),a=n.n(o);for(var i in o)"default"!==i&&function(t){n.d(e,t,(function(){return o[t]}))}(i);e["default"]=a.a}},[["1a30","common/runtime","common/vendor"]]]);