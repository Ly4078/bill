(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/bill/edit"],{"09a0":function(t,e,n){"use strict";n.r(e);var i=n("f6f1"),a=n("6584");for(var o in a)"default"!==o&&function(t){n.d(e,t,(function(){return a[t]}))}(o);n("f1a3");var s,u=n("f0c5"),r=Object(u["a"])(a["default"],i["b"],i["c"],!1,null,"3d78b9b8",null,!1,i["a"],s);e["default"]=r.exports},"0af6":function(t,e,n){"use strict";(function(t,i){function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u(t){return l(t)||c(t)||r()}function r(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function c(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function l(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var d=function(){return n.e("node-modules/_@dcloudio_uni-ui@1.1.8@@dcloudio/uni-ui/lib/uni-popup/uni-popup").then(n.bind(null,"b50e"))},h=function(){return n.e("node-modules/_@dcloudio_uni-ui@1.1.8@@dcloudio/uni-ui/lib/uni-nav-bar/uni-nav-bar").then(n.bind(null,"fc91"))},f=function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/_@dcloudio_uni-ui@1.1.8@@dcloudio/uni-ui/lib/uni-icons/uni-icons")]).then(n.bind(null,"cc1c"))},p=function(){return n.e("node-modules/_@buuug7_uniapp-components@0.7.0@@buuug7/uniapp-components/lib/simple-datetime-picker/index").then(n.bind(null,"b9e0"))},m={components:{uniIcons:f,uniNavBar:h,uniPopup:d,simpleDatetimePicker:p},data:function(){return{statusDay:"2020-03-02 0:0",endDay:"2020-03-04 23:59",startTime:"",endTime:"",second:864e5,fives:18e6,twenty:828e5,executionNum:0,Token:t.getStorageSync("userId")||"",isAgain:!1,ismodel:!1,ismolnum:1,paytype:[],idArr:[],types:{collect:[],branch:[]},dataobj:{genre:1,amount:"",useDate:"",payType:{},useType:{},remarks:"",picture:""},typeitems:[]}},onLoad:function(t){if(this.paytype=u(this.GlobalJson.paytype),t.item){var e=JSON.parse(t.item);console.log("_dataobj:",e),this.dataobj=e}else this.dataobj.useDate=this.utils.Format(new Date)},onShow:function(){this.gettypelist()},methods:{toback:function(){this.dataobj._id?t.redirectTo({url:"./details?id="+this.dataobj._id}):t.navigateBack({delta:1})},firstAgin:function(){this.startTime=new Date,this.first()},first:function(){var e=this,n=this,i=new Date(new Date(this.statusDay).getTime()+this.second);if(this.statusDay=this.utils.Format(i),console.log("=====================================",this.statusDay),new Date(this.endDay).getTime()<new Date(this.statusDay).getTime()){this.endTime=new Date;var a=parseInt(((new Date).getTime()-this.startTime.getTime())/1e3),o=this.utils.formatSeconds(a);console.log("共执行"+this.executionNum+"次任务,耗时"+o),console.log(this.idArr),t.showModal({title:"提示",mask:!0,content:"任务完成",success:function(t){t.confirm?console.log("用户点击确定"):t.cancel&&console.log("用户点击取消")}})}else var s=this.utils.randomNum(5,9),u=0,r=new Date(this.statusDay).getTime()+this.fives,c=new Date(this.statusDay).getTime()+this.twenty,l=setInterval((function(){if(u<s){u++;var t=e.utils.randomNum(r,c);n.start(new Date(t))}else clearInterval(l),n.first()}),1200)},start:function(t){var e=this.utils.randomNum(1,2),n=this.utils.randomNum(1,13);this.dataobj.genre=e,this.dataobj.amount=this.utils.randomNum(.01,40.99),this.dataobj.remarks=n>5?Math.random().toString(36).slice(-n):"",this.dataobj.picture="../../static/fapiao.jpg",this.dataobj.useType=1==e?this.types.collect[this.utils.randomNum(0,this.types.collect.length-1)]:this.types.branch[this.utils.randomNum(0,this.types.branch.length-1)],this.dataobj.payType=this.paytype[this.utils.randomNum(0,this.paytype.length-1)],this.dataobj.useDate=this.utils.Format(t),this.saveData()},handleexin:function(t){if(this.$refs.popup.close(),this.dataobj.genre=t,this.gettypelist(),this.dataobj._id)this.dataobj.useType={};else{var e={genre:t,amount:"",useDate:"",payType:{},useType:{},remarks:""};e.useDate=this.utils.Format(new Date),this.dataobj=e}},gettypelist:function(){var e=this;t.showLoading({title:"数据加载中...",mask:!0}),i.callFunction({name:"settype",data:{pay:4,token:this.Token,genre:this.dataobj.genre}}).then((function(n){t.hideLoading();var i=[{iconclass:"iconjia",label:"编辑",isadd:!0}];if(0==n.result.status){e.isnull=!1;var a=u(n.result.list.data);e.typeitems=[].concat(u(a),i),console.log("typeitems:",e.typeitems)}else e.typeitems=[].concat(i),t.showToast({title:n.result.msg,icon:"none"})})).catch((function(e){t.hideLoading(),t.showModal({content:"操作失败，请重新操作",showCancel:!1})}))},showModel:function(t){this.ismolnum=t,this.$refs.popup.open()},upload:function(){var e=this;new Promise((function(e,n){t.chooseImage({chooseImage:1,success:function(t){var n=t.tempFilePaths[0],i={filePath:n};e(i)},fail:function(){n(new Error("Fail_Cancel"))}})})).then((function(e){return t.showLoading({title:"文件上传中..."}),i.uploadFile(e)})).then((function(n){t.hideLoading(),t.showToast({title:"图片上传成功",mask:!0}),e.dataobj.picture=n.fileID})).catch((function(e){t.hideLoading(),console.log(e),"Fail_Cancel"!==e.message&&t.showModal({content:"图片上传失败，请重新上传",showCancel:!1})}))},seeimgsrc:function(){this.$refs.picture.open()},closeimgSrc:function(){this.dataobj.picture=""},saveData:function(){var e=this;if(this.dataobj.amount)if(this.dataobj.payType.label)if(this.dataobj.useType.label){t.showLoading({title:"数据保存中...",mask:!0});var n=o({},this.dataobj),a="",s=this;n.useDategetTime=new Date(n.useDate).getTime();var u=n.useDate.split(" "),r=u[0].split("-");n.useYear=r[0],n.useMonth=r[1],n.useDay=r[2],n.useHour=u[1],n.token=this.Token,a=n._id?"update":"add",i.callFunction({name:a,data:n}).then((function(i){if(console.log(i),i.result.id){if(e.idArr.push(i.result.id),e.executionNum++,t.hideLoading(),t.showToast({title:"数据保存成功",mask:!0,duration:2e3}),n.dataId){n._id=n.dataId,delete n.dataId;try{t.setStorageSync("editData",n)}catch(a){}}setTimeout((function(){s.toback()}),2500)}else t.showToast({title:"保存失败，请重新输入",icon:"none",mask:!0,duration:2e3})})).catch((function(e){t.hideLoading(),t.showToast({title:"数据保存失败，请重新保存",mask:!0,icon:"none",duration:2e3}),console.error(e)}))}else t.showToast({title:"请选择方式",icon:"none"});else t.showToast({title:"请选择方式",icon:"none"});else t.showToast({title:"请输入金额",icon:"none"})},handlepay:function(t){this.dataobj.payType=t,this.$refs.popup.close()},handleType:function(e){this.$refs.popup.close(),e.isadd?t.navigateTo({url:"./typelist?genre="+this.dataobj.genre}):this.dataobj.useType=e},openDatetimePicker:function(){this.$refs.myPicker.show()},closeDatetimePicker:function(){this.$refs.myPicker.hide()},handleSubmit:function(t){t.year&&t.month&&t.day&&(this.dataobj.useDate="".concat(t.year,"-").concat(t.month,"-").concat(t.day," ").concat(t.hour,":").concat(t.minute))}}};e.default=m}).call(this,n("543d")["default"],n("a9ff")["default"])},1287:function(t,e,n){"use strict";(function(t){n("99cf"),n("921b");i(n("66fd"));var e=i(n("09a0"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},6584:function(t,e,n){"use strict";n.r(e);var i=n("0af6"),a=n.n(i);for(var o in i)"default"!==o&&function(t){n.d(e,t,(function(){return i[t]}))}(o);e["default"]=a.a},"6bbc":function(t,e,n){},f1a3:function(t,e,n){"use strict";var i=n("6bbc"),a=n.n(i);a.a},f6f1:function(t,e,n){"use strict";var i,a=function(){var t=this,e=t.$createElement;t._self._c},o=[];n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return i}))}},[["1287","common/runtime","common/vendor"]]]);