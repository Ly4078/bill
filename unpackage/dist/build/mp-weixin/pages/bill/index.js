(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/bill/index"],{"0a88":function(t,n,e){"use strict";var o,i=function(){var t=this,n=t.$createElement;t._self._c;t._isMounted||(t.e0=function(n){t.iseye=!t.iseye})},a=[];e.d(n,"b",(function(){return i})),e.d(n,"c",(function(){return a})),e.d(n,"a",(function(){return o}))},"3a19":function(t,n,e){"use strict";e.r(n);var o=e("9924"),i=e.n(o);for(var a in o)"default"!==a&&function(t){e.d(n,t,(function(){return o[t]}))}(a);n["default"]=i.a},"5c8b":function(t,n,e){"use strict";e.r(n);var o=e("0a88"),i=e("3a19");for(var a in i)"default"!==a&&function(t){e.d(n,t,(function(){return i[t]}))}(a);e("628e");var u,r=e("f0c5"),s=Object(r["a"])(i["default"],o["b"],o["c"],!1,null,"792528f0",null,!1,o["a"],u);n["default"]=s.exports},"628e":function(t,n,e){"use strict";var o=e("903f"),i=e.n(o);i.a},"903f":function(t,n,e){},9924:function(t,n,e){"use strict";(function(t,o){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=e("2f62");function a(t){return s(t)||r(t)||u()}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function r(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function s(t){if(Array.isArray(t)){for(var n=0,e=new Array(t.length);n<t.length;n++)e[n]=t[n];return e}}function c(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,o)}return e}function d(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?c(Object(e),!0).forEach((function(n){l(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):c(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function l(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var h=function(){return e.e("node-modules/_@dcloudio_uni-ui@1.1.8@@dcloudio/uni-ui/lib/uni-nav-bar/uni-nav-bar").then(e.bind(null,"fc91"))},f=function(){return e.e("node-modules/_@dcloudio_uni-ui@1.1.8@@dcloudio/uni-ui/lib/uni-pagination/uni-pagination").then(e.bind(null,"c6d6"))},g=function(){return Promise.all([e.e("common/vendor"),e.e("node-modules/_@dcloudio_uni-ui@1.1.8@@dcloudio/uni-ui/lib/uni-icons/uni-icons")]).then(e.bind(null,"cc1c"))},m=function(){return e.e("node-modules/_@dcloudio_uni-ui@1.1.8@@dcloudio/uni-ui/lib/uni-list-item/uni-list-item").then(e.bind(null,"8f42"))},p=function(){return e.e("node-modules/_@dcloudio_uni-ui@1.1.8@@dcloudio/uni-ui/lib/uni-popup/uni-popup").then(e.bind(null,"b50e"))},b=function(){return e.e("node-modules/_@dcloudio_uni-ui@1.1.8@@dcloudio/uni-ui/lib/uni-list/uni-list").then(e.bind(null,"c806"))},v=function(){return e.e("node-modules/_@dcloudio_uni-ui@1.1.8@@dcloudio/uni-ui/lib/uni-card/uni-card").then(e.bind(null,"a6cd"))},y={components:{uniCard:v,uniList:b,uniPopup:p,uniListItem:m,uniIcons:g,uniPagination:f,uniNavBar:h},computed:d({},(0,i.mapState)(["hasLogin"])),onLoad:function(){var n=t.getStorageSync("userId")||"";n?this.Token=n:this.getOpenId(),this.navs=a(this.Navs.navs);var e=new Date;this.nowdate={year:String(e.getFullYear()),month:String(Number(e.getMonth()+1)<10?"0"+(e.getMonth()+1):e.getMonth()+1),day:String(Number(e.getDate()+1)<10?"0"+e.getDate():e.getDate())}},onShow:function(){var n=t.getStorageSync("userId")||"";n&&(console.log("userId:",n),this.getSummary(),this.getData())},data:function(){return{navs:[],Token:"",lists:[],budget:"",imgUrl:"",pageNum:0,opearObj:{},isnull:!1,iseye:!1,isbudget:!1,isoperat:!1,nowdate:{year:"",month:"",day:"",startTime:"",endTime:""},summary:{budgetotal:0,budgetId:"",exAmount:0,inAmount:0}}},methods:d({},(0,i.mapMutations)(["login"]),{getOpenId:function(){var n=this;t.login({provider:"weixin",success:function(t){o.callFunction({name:"getUnionid",data:{js_code:t.code}}).then((function(t){n.wxLogin(t.result.data.openid)}))}})},wxLogin:function(n){var e=this;o.callFunction({name:"login",data:{openid:n}}).then((function(n){console.log("res:",n),0==n.result.status&&(e.login(n.result.token),e.Token=n.result.token,e.getSummary(),e.getData()),1==n.result.status&&t.reLaunch({url:"./login?id="+n.result.token})}))},getSummary:function(){var n=this;console.log("getSummary:"),t.showLoading({mask:!0,title:"数据加载中..."});var e={range:"month",token:this.Token,yearMonth:this.nowdate.year+"-"+this.nowdate.month,year:this.nowdate.year,month:this.nowdate.month};o.callFunction({name:"summary",data:e}).then((function(e){t.hideLoading(),n.summary=e.result,n.budget=e.result.budgetotal})).catch((function(n){t.hideLoading(),t.showModal({content:"查询失败，错误信息为：".concat(n.message),showCancel:!1}),console.error(n)}))},getData:function(){var n=this;console.log("getData"),t.showLoading({mask:!0,title:"数据加载中..."});var e={token:this.Token,pageNum:this.pageNum,range:"day",year:this.nowdate.year,month:this.nowdate.month,day:this.nowdate.day};o.callFunction({name:"get",data:e}).then((function(e){t.hideLoading();var o=0,i=0;if(e.result.total>0){n.isnull=!1,e.result.list.forEach((function(t){t.weekday=n.utils.getMyDay(t.useDate),1==t.genre?o+=Number(t.amount):2==t.genre&&(i+=Number(t.amount))}));var a={datetime:"".concat(n.nowdate.year,"-").concat(n.nowdate.month,"-").concat(n.nowdate.day),budget:"收入：".concat(i," 支出：").concat(o),listItem:e.result.list};n.lists=[],n.lists.push(a)}else n.isnull=!0})).catch((function(e){t.hideLoading(),n.lists=[],n.isnull=!0,t.showToast({icon:"none",mask:!0,title:"未查询到相关信息"})}))},setbudget:function(){this.isbudget=!0,this.isoperat=!1,this.$refs.indpopup.open()},submitBudget:function(){var n=this;t.showLoading({mask:!0,title:"处理中..."});var e=this.nowdate.year+"-"+this.nowdate.month,i="",a={yearMonth:e,createTime:new Date(e).getTime(),budgetTotal:this.budget,token:this.Token};this.summary.budgetId?(i="updateBudget",a.budgetId=this.summary.budgetId):i="budget",o.callFunction({name:i,data:a}).then((function(e){t.hideLoading(),n.$refs.indpopup.close(),n.isbudget=!1,t.showModal({content:"设置成功",showCancel:!1}),n.getSummary()})).catch((function(e){n.$refs.indpopup.close(),n.isbudget=!1,t.hideLoading(),t.showModal({content:"设置失败，请重新设置",showCancel:!1}),console.error(e)}))},clickSearch:function(){this.$refs.navs.close(),this.$refs.picture.close(),this.$refs.indpopup.close(),t.navigateTo({url:"./search"})},handleItem:function(n){t.navigateTo({url:"./details?id="+n})},handleLong:function(t){this.opearObj=t,this.isoperat=!0,this.isbudget=!1,this.$refs.indpopup.open()},onshowproof:function(t){this.imgUrl=t,this.$refs.picture.open()},moreOper:function(n){var e=this;1==n?this.handleItem(this.opearObj._id):t.showModal({title:"提示",content:"是否确认删除此条数据？",success:function(n){n.confirm?(t.showLoading({title:"数据删除中..."}),o.callFunction({name:"remove",data:{token:e.Token,dataId:e.opearObj._id}}).then((function(n){t.hideLoading(),t.showToast({title:n.result.msg,icon:"none",duration:2e3}),e.getData()})).catch((function(n){t.hideLoading(),t.showModal({content:"操作失败，请重新操作",showCancel:!1}),console.error(n)}))):n.cancel&&console.log("用户点击取消")}}),this.isoperat=!1,this.$refs.indpopup.close()},openNavs:function(){t.navigateTo({url:"./annal"})},handleNav:function(n){this.$refs.navs.close(),1==n.id?t.navigateTo({url:"./about"}):2==n.id?t.navigateTo({url:"./site"}):3==n.id&&t.navigateTo({url:"./annal"})}})};n.default=y}).call(this,e("543d")["default"],e("a9ff")["default"])},dd8e:function(t,n,e){"use strict";(function(t){e("99cf"),e("921b");o(e("66fd"));var n=o(e("5c8b"));function o(t){return t&&t.__esModule?t:{default:t}}t(n.default)}).call(this,e("543d")["createPage"])}},[["dd8e","common/runtime","common/vendor"]]]);