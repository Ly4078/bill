(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/bill/index"],{2847:function(t,n,e){"use strict";e.r(n);var o=e("7d6f"),i=e.n(o);for(var a in o)"default"!==a&&function(t){e.d(n,t,(function(){return o[t]}))}(a);n["default"]=i.a},"377d":function(t,n,e){},"430e":function(t,n,e){"use strict";var o=e("377d"),i=e.n(o);i.a},"7d6f":function(t,n,e){"use strict";(function(t,o){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=e("2f62");function a(t){return c(t)||s(t)||u(t)||r()}function r(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(t,n){if(t){if("string"===typeof t)return l(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(e):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?l(t,n):void 0}}function s(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function c(t){if(Array.isArray(t))return l(t)}function l(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,o=new Array(n);e<n;e++)o[e]=t[e];return o}function d(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,o)}return e}function h(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?d(Object(e),!0).forEach((function(n){f(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):d(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function f(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var g=function(){e.e("node-modules/@dcloudio/uni-ui/lib/uni-nav-bar/uni-nav-bar").then(function(){return resolve(e("c389"))}.bind(null,e)).catch(e.oe)},m=function(){e.e("node-modules/@dcloudio/uni-ui/lib/uni-pagination/uni-pagination").then(function(){return resolve(e("36e8"))}.bind(null,e)).catch(e.oe)},p=function(){Promise.all([e.e("common/vendor"),e.e("node-modules/@dcloudio/uni-ui/lib/uni-icons/uni-icons")]).then(function(){return resolve(e("8abe"))}.bind(null,e)).catch(e.oe)},b=function(){Promise.all([e.e("common/vendor"),e.e("node-modules/@dcloudio/uni-ui/lib/uni-list-item/uni-list-item")]).then(function(){return resolve(e("2e5a"))}.bind(null,e)).catch(e.oe)},v=function(){e.e("node-modules/@dcloudio/uni-ui/lib/uni-popup/uni-popup").then(function(){return resolve(e("d00b"))}.bind(null,e)).catch(e.oe)},y=function(){e.e("node-modules/@dcloudio/uni-ui/lib/uni-list/uni-list").then(function(){return resolve(e("a215"))}.bind(null,e)).catch(e.oe)},w=function(){e.e("node-modules/@dcloudio/uni-ui/lib/uni-card/uni-card").then(function(){return resolve(e("e6f9"))}.bind(null,e)).catch(e.oe)},O={components:{uniCard:w,uniList:y,uniPopup:v,uniListItem:b,uniIcons:p,uniPagination:m,uniNavBar:g},computed:h({},(0,i.mapState)(["hasLogin"])),onLoad:function(){this.init()},onShow:function(){var n=t.getStorageSync("userId")||"";n&&(console.log("onshow-userId:",n),this.getSummary(),this.getData())},data:function(){return{navs:[],Token:"",Iversion:0,lists:[],budget:"",imgUrl:"",pageNum:0,opearObj:{},isnull:!1,iseye:!1,isbudget:!1,isoperat:!1,nowdate:{year:"",month:"",day:"",startTime:"",endTime:""},summary:{budgetotal:0,budgetId:"",exAmount:0,inAmount:0}}},methods:h({init:function(){var n=t.getStorageSync("userId")||"";n?this.Token=n:this.getOpenId(),this.navs=a(this.Navs.navs);var e=new Date;this.nowdate={year:String(e.getFullYear()),month:String(Number(e.getMonth()+1)<10?"0"+(e.getMonth()+1):e.getMonth()+1),day:String(Number(e.getDate()+1)<10?"0"+e.getDate():e.getDate())}}},(0,i.mapMutations)(["login"]),{getOpenId:function(){var n=this;t.login({provider:"weixin",success:function(t){o.callFunction({name:"getUnionid",data:{js_code:t.code}}).then((function(t){n.wxLogin(t.result.data.openid)}))}})},wxLogin:function(n){var e=this;console.log("wxlogin");o.callFunction({name:"login",data:{openid:n}}).then((function(n){console.log("resa:",n),0==n.result.status&&(console.log("token:",n.result.token),e.login(n.result.token),e.Token=n.result.token,e.getSummary(),e.getData()),1==n.result.status&&t.reLaunch({url:"./login?id="+n.result.token})}))},getSummary:function(){var n=this;t.showLoading({mask:!0,title:"数据加载中..."});var e={range:"month",token:this.Token,yearMonth:this.nowdate.year+"-"+this.nowdate.month,year:this.nowdate.year,month:this.nowdate.month};o.callFunction({name:"summary",data:e}).then((function(e){t.hideLoading(),n.summary=e.result,n.budget=e.result.budgetotal})).catch((function(n){t.hideLoading(),t.showModal({content:"查询失败，错误信息为：".concat(n.message),showCancel:!1}),console.error(n)}))},getData:function(){var n=this;t.showLoading({mask:!0,title:"数据加载中..."});var e={token:this.Token,pageNum:this.pageNum,range:"day",year:this.nowdate.year,month:this.nowdate.month,day:this.nowdate.day};o.callFunction({name:"get",data:e}).then((function(e){t.hideLoading();var o=0,i=0;if(e.result.total>0){n.isnull=!1,e.result.list.forEach((function(t){1==t.genre?o+=Number(t.amount):2==t.genre&&(i+=Number(t.amount))}));var a={datetime:"".concat(n.nowdate.year,"-").concat(n.nowdate.month,"-").concat(n.nowdate.day),budget:"收入：".concat(i," 支出：").concat(o),listItem:e.result.list};n.lists=[],n.lists.push(a)}else n.isnull=!0})).catch((function(e){t.hideLoading(),n.lists=[],n.isnull=!0,t.showToast({icon:"none",mask:!0,title:"未查询到相关信息"})}))},setbudget:function(){this.isbudget=!0,this.isoperat=!1,this.$refs.indpopup.open()},submitBudget:function(){var n=this;t.showLoading({mask:!0,title:"处理中..."});var e=this.nowdate.year+"-"+this.nowdate.month,i="",a={yearMonth:e,createTime:new Date(e).getTime(),budgetTotal:this.budget,token:this.Token};this.summary.budgetId?(i="updateBudget",a.budgetId=this.summary.budgetId):i="budget",o.callFunction({name:i,data:a}).then((function(e){t.hideLoading(),n.$refs.indpopup.close(),n.isbudget=!1,t.showModal({content:"设置成功",showCancel:!1}),n.getSummary()})).catch((function(e){n.$refs.indpopup.close(),n.isbudget=!1,t.hideLoading(),t.showModal({content:"设置失败，请重新设置",showCancel:!1}),console.error(e)}))},clickSearch:function(){this.$refs.navs.close(),this.$refs.picture.close(),this.$refs.indpopup.close(),t.navigateTo({url:"./search"})},handleItem:function(n){t.navigateTo({url:"./details?id="+n})},handleLong:function(t){this.opearObj=t,this.isoperat=!0,this.isbudget=!1,this.$refs.indpopup.open()},onshowproof:function(t){this.imgUrl=t,this.$refs.picture.open()},moreOper:function(n){var e=this;1==n?this.handleItem(this.opearObj._id):t.showModal({title:"提示",content:"是否确认删除此条数据？",success:function(n){n.confirm?(t.showLoading({title:"数据删除中..."}),o.callFunction({name:"remove",data:{token:e.Token,dataId:e.opearObj._id}}).then((function(n){t.hideLoading(),t.showToast({title:n.result.msg,icon:"none",duration:2e3}),e.getData()})).catch((function(n){t.hideLoading(),t.showModal({content:"操作失败，请重新操作",showCancel:!1}),console.error(n)}))):n.cancel&&console.log("用户点击取消")}}),this.isoperat=!1,this.$refs.indpopup.close()},openNavs:function(){this.$refs.navs.open()},handleNav:function(n){this.$refs.navs.close(),1==n.id?t.navigateTo({url:"./about"}):2==n.id?t.navigateTo({url:"./site"}):3==n.id&&t.navigateTo({url:"./annal"})}})};n.default=O}).call(this,e("543d")["default"],e("a9ff")["default"])},"8f51":function(t,n,e){"use strict";e.r(n);var o=e("a495"),i=e("2847");for(var a in i)"default"!==a&&function(t){e.d(n,t,(function(){return i[t]}))}(a);e("430e");var r,u=e("f0c5"),s=Object(u["a"])(i["default"],o["b"],o["c"],!1,null,"0d6a0548",null,!1,o["a"],r);n["default"]=s.exports},a495:function(t,n,e){"use strict";var o,i=function(){var t=this,n=t.$createElement,e=(t._self._c,(t.summary.budgetotal-t.summary.exAmount).toFixed(2));t._isMounted||(t.e0=function(n){t.iseye=!t.iseye}),t.$mp.data=Object.assign({},{$root:{g0:e}})},a=[];e.d(n,"b",(function(){return i})),e.d(n,"c",(function(){return a})),e.d(n,"a",(function(){return o}))},e79d:function(t,n,e){"use strict";(function(t){e("b40f"),e("921b");o(e("66fd"));var n=o(e("8f51"));function o(t){return t&&t.__esModule?t:{default:t}}t(n.default)}).call(this,e("543d")["createPage"])}},[["e79d","common/runtime","common/vendor"]]]);